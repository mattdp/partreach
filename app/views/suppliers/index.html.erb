<% provide(:title,"Supplier Profiles") %>
<% meta_description "600+ catalogued 3D printing suppliers with descriptions, machines, and reviews" %>

<div class="content">
	<div class="container row supplier-list">
		<div id="supplier-list-intro">
			<p>We have 600+ suppliers catalogued, representing 20+ countries. This is the set of US 3D printing suppliers we currently have catalogued, focused initially on national and California suppliers. We will add other countries soon.</p>

			<p>Suppliers are sorted by profile completeness, since supplier profiles with descriptions, machine data, and reviews are more informative. If you're a supplier, find your profile, claim it, and increase your ranking!</p>

			<p>Are we missing a supplier that you know about? Please <%= mail_to "suggest-edits@supplybetter.com", "let us know!", encode: "javascript", target: "_blank", subject: "Suggested addition to SupplyBetter database" %></p>
		</div>

		<%= render partial: "suppliers/supplier_list_key" %>

		<p class="clear">Navigate to a US state:</p>
		<% @to_index.each do |state| %>
			<%= "|" if state != @to_index[0] %>
			<%= link_to "#{state}", suppliers_path(anchor: "US-#{state}") %>
		<% end %>

		<% @visibles.keys.each do |country| %>
			<h3 class="supplier-list-country"><%= "#{country}" %></h3>
			<% @visibles[country].keys.each do |state| %>
				<%== "<h4 class=\"supplier-list-state fleft\" id=\"#{country}-#{state}\">" %>
					<% if state == "no_state" %>
						<%= "Many-state / No state" %>
					<% else %> 
						<%= "#{state}" %>
					<% end %>
				</h4>
				<%= link_to "Back to top", suppliers_path(anchor: "supplier-list-intro"), :class => "supplier-list-back-to-top fright" %>
				<table class="clear">
					<% columns = 3 %>
					<% counter = 0 %>
					<ul class="supplier-list-bullets">
						<tr>
							<% @visibles[country][state].each do |supplier,machine_count,review_count,claimed,out_of_business| %>
								<% if counter >= columns %>
									</tr><tr>
									<% counter = 0 %>
								<% end %>
								<% if %>
									<td>
										<li>
											<%= render partial: "suppliers/supplier_link_and_icons", locals: {supplier: supplier, machine_count: machine_count, review_count: review_count, claimed: claimed, out_of_business: out_of_business} %>
										</li>
									</td>
									<% counter += 1 %>
								<% end %>
							<% end %>
							<% while !(counter >= columns) %>
								<td></td>
								<% counter += 1 %>
							<% end %>
						</tr>
					</ul>
				</table>
			<% end %> 
		<% end %>
	</div>
</div>