<% provide(:title,"Part manipulation for order #{@order.id}") %>

<div class="container">
  <div class="row">
  	<div class="col-sm-10 col-sm-offset-1 main-area-contrast override">
  		<p><%= link_to "Manipulate dialogues", manipulate_path(@order) %> - edit order group names here.</p>
  		<p><%= link_to "Order show", order_path(@order) %></p>
  		<p><%= link_to "Add an order group", new_order_group_path(order_id: @order.id) %></p>
  		<h3 class="center">View and edit parts for order <%= "#{@order.id}" %></h3>
		<%= form_tag :action => 'update_parts', :controller => 'orders' do %>
  		  <table>
				<tr>
					<th>Part id</th>
					<th>Part name</th>
					<th>Order Group</th>
					<th>Quantity</th>
					<th>Part file</th>
				</tr>
	  		<% @order_groups.each do |order_group| %>
	  			<% order_group.parts.each do |part| %>
	  				<tr>
	  					<td><%= "#{part.id}" %></td>
	  					<td><%= "#{part.name}" %></td>
	  					<td><%= "#{order_group.name}" %></td>
	  					<td><%= "#{part.quantity}" %></td>
	  					<td><%= link_to "Part file", "#{part.external.url}" if (part.external and part.external.url.present?) %></td>
	  				</tr>
	  			<% end %>
	  		<% end %>
		  </table>

		  <div class="clear">
			<%= submit_tag "Save changes", :disable_with => "Saving...", :class => "save-button" %>
		  </div>
		<% end %>	
  	</div>
  </div>
</div>