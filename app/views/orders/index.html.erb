<% provide(:title, "My orders") %>

<% if @orders.size > 0 %>

  <h1 class="order_top_header">My orders</h1>

  <table class="order_table">
    <tr class="order_table_header_row">
      <th>Order name</th>
      <th>Quantity</th>
      <th>Bid due date</th>
      <th>Status</th>
      <th>Actions</th>
      <th></th>
      <th></th>
    </tr>

  <% @orders.each do |order| %>

    <tr class="order_table_content_row">
      <td><%= order.name %></td>
      <td><%= order.quantity %></td>
      <td>
        <% if not(order.deadline.nil?) %>
          <%= "Due by #{order.deadline.to_s}" %>
        <% end %>
      </td>
      <td>
        <% if order.is_over_without_winner %>
          <%= "Bidding concluded, no deal." %>
        <% elsif winner(order) %>
          <%= "'#{Supplier.find(winner(order).supplier_id).name}' selected as winner." %>     
        <% else %> 
          <%= "#{pluralize(bids_received(order),'bid')} received, " %>
          <%= "#{pluralize(order.dialogues.count, 'supplier')} contacted" %>
        <% end %>
      </td>
      <td><%= link_to 'View order and bids', order %></td>
    </tr>
  <% end %>
  </table>

  <h3><%= link_to 'Create a new order', new_order_path %></h3>

<% else %>
  <p> No orders yet! Make a <%= link_to 'new request for quotes', new_order_path %> now! </p>
<% end %>