<% provide(:title, "My requests for quotes") %>

<div class="content order">
  <div class="container row">

    <% if @orders.size > 0 %>

      <h1 class="order_top_header">My requests for quotes</h1>

      <table class="order_table">
        <tr class="order_table_header_row">
          <th>Order name</th>
          <th>Quantity</th>
          <th>Bid due date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>

      <% @orders.each do |order| %>

        <tr class="order_table_content_row">
          <td><%= order.name %></td>
          <td class="right"><%= order.quantity %></td>
          <td class="center">
            <% if not(order.deadline.nil?) %>
              <%= "Due by #{order.deadline.to_s}" %>
            <% end %>
          </td>
          <td class="center">
            <% if winner(order).nil? and order.finished? %>
              <%= "Bidding concluded, no deal." %>
            <% elsif winner(order) %>
              <%= "'#{Supplier.find(winner(order).supplier_id).name}' selected as winner." %>
            <% else %>
              <%= "#{pluralize(bids_received(order),'bid')} received, " %>
              <%= "#{pluralize(order.visible_dialogues.count, 'supplier')} contacted" %>
            <% end %>
          </td>
          <td class="center"><%= link_to 'View order and bids', order %></td>
        </tr>
      <% end %>
      </table>

      <p><%= link_to 'Or create a new RFQ', new_order_path %></p>

    <% else %>
      <p> No orders yet! Make a <%= link_to 'new request for quotes', new_order_path %> now! </p>
    <% end %>
  </div>
</div>
